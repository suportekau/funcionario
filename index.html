<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sistema Funcionários — Enter Navegação</title>
<style>
  body{font-family:Arial,sans-serif;background:#f4f4f4;margin:0;padding:10px;min-height:100vh;display:flex;align-items:center;justify-content:center;box-sizing:border-box;text-transform:uppercase;}
  .container{background:#fff;padding:20px;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,.12);width:100%;max-width:420px;box-sizing:border-box;}
  h2{margin:0 0 12px 0;font-size:1.2rem;}
  input,select,button{width:100%;padding:10px;margin:6px 0;border-radius:6px;border:1px solid #ccc;box-sizing:border-box;font-size:15px;text-transform:uppercase;}
  button{background:#007bff;color:#fff;border:none;cursor:pointer;}
  button:hover{background:#0056b3;}
  .btn-voltar{background:#6c757d;}
  .btn-voltar:hover{background:#565e64;}
  .hidden{display:none;}
  .lista{max-height:300px;overflow:auto;margin-top:8px;text-align:left;}
  .item{background:#f1f3f5;padding:8px;border-radius:6px;margin:6px 0;display:flex;justify-content:space-between;align-items:center;}
  .btn-excluir{width:34px;height:34px;border-radius:50%;background:#dc3545;color:#fff;border:none;cursor:pointer;}
  .muted{font-size:12px;text-transform:none;color:#666;margin-top:6px;}
  @media(max-width:420px){.container{padding:14px}h2{font-size:1rem}}
</style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<!-- LOGIN -->
<div class="container" id="loginContainer">
  <h2>Login</h2>
  <input id="loginUsuario" placeholder="Usuário" autocomplete="off" />
  <input id="loginSenha" placeholder="Senha" type="password" autocomplete="off" />
  <button id="btnEntrar">Entrar</button>
  <p class="muted">Digite suas credenciais</p>
</div>

<!-- MENU PRINCIPAL -->
<div class="container hidden" id="menu">
  <h2>Menu Principal</h2>
  <button id="btnCadastro">Cadastro</button>
  <button id="btnLancamento">Lançamento</button>
  <button id="btnGerarPDF">Gerar Relatório (PDF)</button>
  <button class="btn-voltar" id="btnSair">Sair</button>
</div>

<!-- MENU CADASTRO -->
<div class="container hidden" id="menuCadastro">
  <h2>Cadastro</h2>
  <button id="btnInserir">Inserir</button>
  <button id="btnConsultar">Consultar</button>
  <button class="btn-voltar" id="btnVoltarMenu">Voltar</button>
</div>

<!-- INSERIR FUNCIONÁRIO -->
<div class="container hidden" id="inserir">
  <h2>Inserir / Editar Funcionário</h2>
  <input type="hidden" id="idEditando" />
  <input id="nome" placeholder="Nome" />
  <input id="cargo" placeholder="Cargo" />
  <button id="btnSalvarFuncionario">Salvar</button>
  <button class="btn-voltar" id="btnVoltarCadastro">Voltar</button>
</div>

<!-- CONSULTAR FUNCIONÁRIOS -->
<div class="container hidden" id="consultar">
  <h2>Consultar Funcionários</h2>
  <input id="filtroFuncionarios" placeholder="Filtrar por nome" />
  <div class="lista" id="listaFuncionarios"></div>
  <button class="btn-voltar" id="btnVoltarConsulta">Voltar</button>
</div>

<!-- MENU LANÇAMENTO -->
<div class="container hidden" id="menuLancamento">
  <h2>Lançamentos</h2>
  <button id="btnInserirLanc">Inserir</button>
  <button id="btnConsultarLanc">Consultar</button>
  <button class="btn-voltar" id="btnVoltarMenuLanc">Voltar</button>
</div>

<!-- INSERIR LANÇAMENTO -->
<div class="container hidden" id="inserirLanc">
  <h2>Inserir / Editar Lançamento</h2>
  <input type="hidden" id="idLancEditando" />
  <select id="tipoLanc">
    <option value="">SELECIONE TIPO</option>
    <option value="VALE">VALE</option>
    <option value="COMPRA">COMPRA</option>
  </select>
  <input list="datalistFuncionarios" id="nomeLanc" placeholder="Nome do Funcionário" />
  <datalist id="datalistFuncionarios"></datalist>
  <input id="dataLanc" type="date" />
  <input id="valorLanc" type="number" step="0.01" placeholder="Valor (Ex: 50.00)" />
  <button id="btnSalvarLanc">Salvar</button>
  <button class="btn-voltar" id="btnVoltarLanc">Voltar</button>
</div>

<!-- CONSULTAR LANÇAMENTOS -->
<div class="container hidden" id="consultarLanc">
  <h2>Consultar Lançamentos</h2>
  <input type="month" id="filtroMes" />
  <input id="filtroLancNome" placeholder="Filtrar por nome" />
  <div class="lista" id="listaLancamentos"></div>
  <button class="btn-voltar" id="btnVoltarConsultaLanc">Voltar</button>
</div>

<!-- SCRIPT PRINCIPAL -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getDatabase, ref, push, set, get, onValue, update, remove } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDH9MG50ynnt4SiXGAFymBH9nXmBqLwTtU",
    authDomain: "funcionarios-7c778.firebaseapp.com",
    databaseURL: "https://funcionarios-7c778-default-rtdb.firebaseio.com/",
    projectId: "funcionarios-7c778",
    storageBucket: "funcionarios-7c778.firebasestorage.app",
    messagingSenderId: "632364021109",
    appId: "1:632364021109:web:f140b97a8dbc36148b4f3c",
    measurementId: "G-2JXX10SBVG"
  };

  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  const $ = id => document.getElementById(id);
  function esconderTudo(){ document.querySelectorAll('.container').forEach(c=>c.classList.add('hidden')); }
  function mostrar(id){ esconderTudo(); $(id).classList.remove('hidden'); }

  function focarLogin(){ setTimeout(()=>{ $('loginUsuario').focus(); },150); }
  window.addEventListener('load', focarLogin);

  // --- Enter navegação
  document.addEventListener('keydown', e=>{
    if(e.key !== 'Enter') return;
    const visiveis = [...document.querySelectorAll('input,select,button')]
      .filter(el=>el.offsetParent!==null && !el.disabled && el.type!=='hidden');
    const i = visiveis.indexOf(e.target);
    if(i===-1) return;
    e.preventDefault();
    const prox = visiveis[i+1];
    if(prox) prox.focus();
    else if(typeof e.target.click==='function') e.target.click();
  });

  // --- Login ---
  $('btnEntrar').addEventListener('click', ()=>{
    const u = $('loginUsuario').value.trim().toUpperCase();
    const s = $('loginSenha').value.trim();
    if(u==='ADMIN' && s==='1234'){ mostrar('menu'); }
    else { alert('Usuário ou senha incorretos!'); focarLogin(); }
  });
  $('btnSair').addEventListener('click', ()=>{ mostrar('loginContainer'); focarLogin(); });

  // --- Menus ---
  $('btnCadastro').onclick=()=>mostrar('menuCadastro');
  $('btnLancamento').onclick=()=>mostrar('menuLancamento');
  $('btnGerarPDF').onclick=()=>gerarPDFRelatorio();

  // --- Cadastro ---
  $('btnInserir').onclick=()=>{ mostrar('inserir'); $('nome').focus(); };
  $('btnConsultar').onclick=()=>{ mostrar('consultar'); carregarFuncionarios(); };
  $('btnVoltarMenu').onclick=()=>mostrar('menu');
  $('btnVoltarCadastro').onclick=()=>mostrar('menuCadastro');
  $('btnVoltarConsulta').onclick=()=>mostrar('menuCadastro');

  // --- Lançamentos ---
  $('btnInserirLanc').onclick=()=>{ atualizarDatalistFuncionarios(); mostrar('inserirLanc'); $('tipoLanc').focus(); };
  $('btnConsultarLanc').onclick=()=>{ mostrar('consultarLanc'); carregarLancamentos(); };
  $('btnVoltarMenuLanc').onclick=()=>mostrar('menu');
  $('btnVoltarLanc').onclick=()=>mostrar('menuLancamento');
  $('btnVoltarConsultaLanc').onclick=()=>mostrar('menuLancamento');

  // (Restante igual: salvar funcionário, carregar, excluir, salvar lançamentos etc.)
  // --- FUNÇÕES DE SALVAR/EXCLUIR/CONSULTAR continuam as mesmas da versão anterior ---
</script>

</body>
</html>
