<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sistema Funcion√°rios</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f4f4f4;
    margin: 0;
    padding: 10px;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    text-transform: uppercase;
    box-sizing: border-box;
  }
  .container {
    background: white;
    padding: 25px;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    text-align: center;
    width: 100%;
    max-width: 380px;
    box-sizing: border-box;
  }
  h2 { margin-bottom: 20px; font-size: 1.4em; }
  input, select {
    width: 100%;
    padding: 10px;
    margin: 5px 0;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 16px;
    box-sizing: border-box;
    text-transform: uppercase;
  }
  button {
    width: 100%;
    padding: 12px;
    margin: 8px 0;
    border: none;
    border-radius: 8px;
    background-color: #007bff;
    color: white;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.2s;
  }
  button:hover { background-color: #0056b3; }
  .btn-voltar { background-color: #6c757d; }
  .btn-voltar:hover { background-color: #565e64; }
  .hidden { display: none; }
  .lista { text-align: left; margin-top: 10px; max-height: 250px; overflow-y: auto; }
  .item {
    display: flex; justify-content: space-between; align-items: center;
    background: #f1f3f5; padding: 6px 8px; border-radius: 6px; margin: 4px 0;
  }
  .btn-excluir {
    width: 28px; height: 28px; background-color:#dc3545; color:white;
    border:none; border-radius:50%; cursor:pointer; font-size:14px;
  }
  .btn-excluir:hover{ background-color:#b02a37; transform: scale(1.1); }
</style>

<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
</head>
<body>

<!-- LOGIN -->
<div class="container" id="loginContainer">
  <h2>Login</h2>
  <input type="text" id="loginUsuario" placeholder="Usu√°rio" />
  <input type="password" id="loginSenha" placeholder="Senha" />
  <button id="btnEntrar">Entrar</button>
</div>

<!-- MENU PRINCIPAL -->
<div class="container hidden" id="menu">
  <h2>Menu Principal</h2>
  <button onclick="abrirCadastro()">Cadastro</button>
  <button onclick="abrirLancamento()">Lan√ßamento</button>
  <button class="btn-voltar" onclick="sair()">Sair</button>
</div>

<!-- CADASTRO -->
<div class="container hidden" id="cadastro">
  <h2>Cadastro Funcion√°rio</h2>
  <input type="hidden" id="idEditando" />
  <input type="text" id="nome" placeholder="Nome" />
  <input type="text" id="cargo" placeholder="Cargo" />
  <button onclick="salvarCadastro()">Salvar</button>
  <button onclick="mostrarCadastros()">Consultar</button>
  <div class="lista" id="listaCadastros"></div>
  <button class="btn-voltar" onclick="voltarMenu()">Voltar</button>
</div>

<!-- LAN√áAMENTO -->
<div class="container hidden" id="lancamento">
  <h2>Lan√ßamento</h2>
  <input list="nomesCadastrados" id="nomeLanc" placeholder="Nome do Funcion√°rio" />
  <datalist id="nomesCadastrados"></datalist>
  <input type="date" id="dataLanc" />
  <select id="tipoLanc">
    <option value="">Selecione Tipo</option>
    <option value="VALE">VALE</option>
    <option value="COMPRA">COMPRA</option>
  </select>
  <input type="number" id="valorLanc" placeholder="Valor" step="0.01" />
  <button onclick="salvarLancamento()">Salvar</button>
  <button onclick="mostrarLancamentos()">Consultar</button>
  <div class="lista" id="listaLancamentos"></div>
  <button onclick="gerarPDFResumoLancamentos()">Gerar PDF</button>
  <button class="btn-voltar" onclick="voltarMenu()">Voltar</button>
</div>

<script>
const loginUsuario = document.getElementById('loginUsuario');
const loginSenha = document.getElementById('loginSenha');
const btnEntrar = document.getElementById('btnEntrar');

// üîπ foco autom√°tico e mai√∫sculas
window.addEventListener('load', () => { loginUsuario.focus(); });
document.addEventListener('input', e => {
  if (e.target.type === 'text') e.target.value = e.target.value.toUpperCase();
});

// üîπ Enter navega no login
loginUsuario.addEventListener('keydown', e => {
  if (e.key === 'Enter') { e.preventDefault(); loginSenha.focus(); }
});
loginSenha.addEventListener('keydown', e => {
  if (e.key === 'Enter') { e.preventDefault(); btnEntrar.click(); }
});

// üîπ Login simples
btnEntrar.addEventListener('click', () => {
  const user = loginUsuario.value.trim().toUpperCase();
  const pass = loginSenha.value.trim();
  if (user === 'ADMIN' && pass === '1234') {
    document.getElementById('loginContainer').classList.add('hidden');
    document.getElementById('menu').classList.remove('hidden');
  } else {
    alert('Usu√°rio ou senha incorretos!');
    loginUsuario.focus();
  }
});

// Navega√ß√£o
function abrirCadastro(){ esconderTudo(); document.getElementById('cadastro').classList.remove('hidden'); atualizarDatalist(); mostrarCadastros(); }
function abrirLancamento(){ esconderTudo(); document.getElementById('lancamento').classList.remove('hidden'); atualizarDatalist(); }
function voltarMenu(){ esconderTudo(); document.getElementById('menu').classList.remove('hidden'); }
function sair(){ esconderTudo(); document.getElementById('loginContainer').classList.remove('hidden'); loginUsuario.focus(); }
function esconderTudo(){ document.querySelectorAll('.container').forEach(d=>d.classList.add('hidden')); }

// CADASTRO
function salvarCadastro(){
  const nome = nomeInput.value.trim().toUpperCase();
  const cargo = cargoInput.value.trim().toUpperCase();
  if(!nome || !cargo) return alert('Preencha todos os campos.');
  let cadastros = JSON.parse(localStorage.getItem('cadastros')) || [];
  const idEditando = idEditandoInput.value;
  if(idEditando){
    const idx = cadastros.findIndex(c => c.id == idEditando);
    cadastros[idx] = { id: +idEditando, nome, cargo };
  } else {
    const novoId = cadastros.length ? cadastros[cadastros.length-1].id + 1 : 1;
    cadastros.push({ id: novoId, nome, cargo });
  }
  localStorage.setItem('cadastros', JSON.stringify(cadastros));
  nomeInput.value = ''; cargoInput.value = ''; idEditandoInput.value = '';
  mostrarCadastros();
}
const nomeInput = document.getElementById('nome');
const cargoInput = document.getElementById('cargo');
const idEditandoInput = document.getElementById('idEditando');

function mostrarCadastros(){
  const lista = document.getElementById('listaCadastros');
  lista.innerHTML = '';
  const cadastros = JSON.parse(localStorage.getItem('cadastros')) || [];
  cadastros.forEach(c=>{
    const div = document.createElement('div');
    div.className='item';
    div.innerHTML=`<span><b>${c.nome}</b> - ${c.cargo}</span>
    <button class="btn-excluir" onclick="excluirCadastro(${c.id})">üóëÔ∏è</button>`;
    lista.appendChild(div);
  });
}
function excluirCadastro(id){
  let cad = JSON.parse(localStorage.getItem('cadastros'))||[];
  cad = cad.filter(c=>c.id!==id);
  localStorage.setItem('cadastros', JSON.stringify(cad));
  mostrarCadastros();
}

// LAN√áAMENTOS
function atualizarDatalist(){
  const dataList = document.getElementById('nomesCadastrados');
  const cad = JSON.parse(localStorage.getItem('cadastros'))||[];
  dataList.innerHTML='';
  cad.forEach(c=>{
    const o=document.createElement('option');
    o.value=c.nome;
    dataList.appendChild(o);
  });
}
function salvarLancamento(){
  const nome = document.getElementById('nomeLanc').value.trim().toUpperCase();
  const data = document.getElementById('dataLanc').value;
  const tipo = document.getElementById('tipoLanc').value;
  const valor = parseFloat(document.getElementById('valorLanc').value);
  if(!nome||!data||!tipo||isNaN(valor)) return alert('Preencha todos os campos.');
  let lanc = JSON.parse(localStorage.getItem('lancamentos'))||[];
  const novoId = lanc.length ? lanc[lanc.length-1].id + 1 : 1;
  lanc.push({ id: novoId, nome, data, tipo, valor });
  localStorage.setItem('lancamentos', JSON.stringify(lanc));
  mostrarLancamentos();
}
function mostrarLancamentos(){
  const lista=document.getElementById('listaLancamentos');
  lista.innerHTML='';
  const lanc=JSON.parse(localStorage.getItem('lancamentos'))||[];
  lanc.forEach(l=>{
    const div=document.createElement('div');
    div.className='item';
    div.innerHTML=`<span>${l.nome} | ${l.data} | ${l.tipo} | R$ ${l.valor.toFixed(2).replace('.',',')}</span>
    <button class="btn-excluir" onclick="excluirLancamento(${l.id})">üóëÔ∏è</button>`;
    lista.appendChild(div);
  });
}
function excluirLancamento(id){
  let lanc=JSON.parse(localStorage.getItem('lancamentos'))||[];
  lanc=lanc.filter(l=>l.id!==id);
  localStorage.setItem('lancamentos', JSON.stringify(lanc));
  mostrarLancamentos();
}

// PDF
function gerarPDFResumoLancamentos(){
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF();
  const lanc=JSON.parse(localStorage.getItem('lancamentos'))||[];
  const resumo={};
  lanc.forEach(l=>{ resumo[l.nome]=(resumo[l.nome]||0)+l.valor; });
  pdf.setFontSize(16);
  pdf.text("RESUMO DE LAN√áAMENTOS", 10, 20);
  let y=30;
  for(const nome in resumo){
    pdf.text(`${nome} ........... R$ ${resumo[nome].toFixed(2).replace('.',',')}`, 10, y);
    y+=8;
  }
  const total=Object.values(resumo).reduce((a,b)=>a+b,0);
  pdf.text(`TOTAL GERAL ........... R$ ${total.toFixed(2).replace('.',',')}`, 10, y+10);
  pdf.save("resumo_lancamentos.pdf");
}
</script>

</body>
</html>
