<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <title>Login Firebase com Atualização de Usuário e Senha</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .hidden { display: none; }
    label { display: block; margin: 8px 0 4px; }
  </style>
</head>
<body>

  <div id="loginDiv">
    <h2>Login</h2>
    <label>Email (usuário): <input type="email" id="emailLogin" /></label>
    <label>Senha: <input type="password" id="senhaLogin" /></label>
    <button onclick="fazerLogin()">Entrar</button>
  </div>

  <div id="conteudo" class="hidden">
    <h2>Bem-vindo!</h2>
    <p id="userEmailDisplay"></p>

    <h3>Alterar usuário (email) e senha</h3>
    <label>Novo email: <input type="email" id="novoEmail" /></label>
    <label>Nova senha: <input type="password" id="novaSenha" /></label>
    <button onclick="alterarCredenciais()">Salvar alterações</button>

    <br><br>
    <button onclick="fazerLogout()">Sair</button>
  </div>

<script>
  // Coloque suas configurações do Firebase aqui (substitua pelos seus dados)
  const firebaseConfig = {
    apiKey: "SUA_API_KEY",
    authDomain: "SEU_AUTH_DOMAIN",
    projectId: "SEU_PROJECT_ID",
    storageBucket: "SEU_STORAGE_BUCKET",
    messagingSenderId: "SEU_MESSAGING_SENDER_ID",
    appId: "SEU_APP_ID"
  };

  // Inicializa Firebase
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();

  // Função para login
  function fazerLogin() {
    const email = document.getElementById('emailLogin').value.trim();
    const senha = document.getElementById('senhaLogin').value.trim();

    if (!email || !senha) {
      alert('Preencha email e senha.');
      return;
    }

    auth.signInWithEmailAndPassword(email, senha)
      .then((userCredential) => {
        alert('Login efetuado com sucesso!');
        mostrarConteudo(userCredential.user);
      })
      .catch((error) => {
        alert('Erro no login: ' + error.message);
      });
  }

  // Mostra conteúdo após login
  function mostrarConteudo(user) {
    document.getElementById('loginDiv').classList.add('hidden');
    document.getElementById('conteudo').classList.remove('hidden');
    document.getElementById('userEmailDisplay').innerText = `Usuário logado: ${user.email}`;

    // Preencher campos para alterar com os dados atuais
    document.getElementById('novoEmail').value = user.email;
    document.getElementById('novaSenha').value = '';
  }

  // Alterar email e senha
  function alterarCredenciais() {
    const user = auth.currentUser;
    const novoEmail = document.getElementById('novoEmail').value.trim();
    const novaSenha = document.getElementById('novaSenha').value.trim();

    if (!user) {
      alert('Nenhum usuário logado.');
      return;
    }

    // Atualizar email
    if (novoEmail && novoEmail !== user.email) {
      user.updateEmail(novoEmail)
        .then(() => {
          alert('Email atualizado com sucesso!');
          document.getElementById('userEmailDisplay').innerText = `Usuário logado: ${novoEmail}`;
        })
        .catch(error => {
          alert('Erro ao atualizar email: ' + error.message);
        });
    }

    // Atualizar senha
    if (novaSenha) {
      if (novaSenha.length < 6) {
        alert('A senha deve ter pelo menos 6 caracteres.');
        return;
      }
      user.updatePassword(novaSenha)
        .then(() => {
          alert('Senha atualizada com sucesso!');
          document.getElementById('novaSenha').value = '';
        })
        .catch(error => {
          alert('Erro ao atualizar senha: ' + error.message);
        });
    }
  }

  // Logout
  function fazerLogout() {
    auth.signOut().then(() => {
      alert('Logout efetuado.');
      document.getElementById('conteudo').classList.add('hidden');
      document.getElementById('loginDiv').classList.remove('hidden');
      document.getElementById('emailLogin').value = '';
      document.getElementById('senhaLogin').value = '';
    });
  }

  // Se o usuário já estiver logado, já mostra conteúdo
  auth.onAuthStateChanged(user => {
    if (user) {
      mostrarConteudo(user);
    } else {
      document.getElementById('conteudo').classList.add('hidden');
      document.getElementById('loginDiv').classList.remove('hidden');
    }
  });

  // Enter no formulário de login
  ['emailLogin', 'senhaLogin'].forEach(id => {
    document.getElementById(id).addEventListener('keypress', e => {
      if (e.key === 'Enter') fazerLogin();
    });
  });
</script>

</body>
</html>
